<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../Styles/style_mod.css">
    <link rel="stylesheet" href="../Styles/style_sec.css">
    <link rel="shortcut icon" href="../Content/Images/favicon.ico" type="image/x-icon">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.3/xlsx.full.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <title>Projeto</title>
</head>
<body>
    <header>
        <div id="pgHead">
                <div id="name">
                    <img src="../Content/Images/cpu 70px.png" alt="imagem chip eletronico" href="../index.html">
                    <h1>Projeto - Solução Questionário Socioeconômico</h1>
                    <div id="project"><button id="AProje"><a href="../index.html">Retornar</a></button></div>
                </div>
        </div>
    </header>
    <div id="content">
            <div id="buttonss">
                
                    <input type="file" name="files" id="fileUpload"  accept=".xls,.xlsx">
                
                <label id="rot" for="fileUpload">
                    <img src="../Content/Images/upload20px.png" alt="upload">
                    Selecione o aquivo
                </label>

                <button class = "nButton" type="button" id="uploadExcel"><img src="../Content/Images/cycle20px.png" alt="cycle"> Converter</button>

                <button class = "nButton" type="button" id="process"><img src="../Content/Images/statistics20px.png" alt="statistic"> Processar dados</button>
            </div>
    </div>
    <div id="graficos"></div>
    <div id="end">
    <footer><strong>
        <p>&copy; Gabriel Jesus & Paulo Chimelo</p>
    </strong></footer> 
    </div>
    <script src="../Scripts/processamento.js"></script>  
    <script>
        
        let sFile;
        let datas
    
        document.getElementById('fileUpload').addEventListener('change',(event)=>{
            sFile = event.target.files[0];
            console.log(event.target.files);
        });
            
    
        
        document.getElementById('uploadExcel').addEventListener('click',()=>{
            console.log("Click")
            if(sFile){
                let fileReader = new FileReader();
                fileReader.readAsBinaryString(sFile);
                fileReader.onload = (event)=>{
                    console.log(event.target.result)
                    let data = event.target.result
                    let workbook = XLSX.read(data,{type:"binary"});
                    console.log(workbook)
                    workbook.SheetNames.forEach(sheet => {
                        let rowObject = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]);
                        console.log(rowObject)
                        datas = rowObject
                    });
                }
            }
        })
    
        document.getElementById('process').addEventListener('click',()=>{
            
            //document.write(datas.length)
            //document.write("<hr><br>")

            //<canvas id="nchart" class="chartsjs" width="33" height="10" ></canvas>
            
            

            for(let i = 1; i <= 42; i++){

                //criando o elemento canvas de forma automática
                let graf = document.getElementById("graficos")
                let canv = document.createElement("canvas")
                graf.appendChild(canv)

                //criando atributos para os canvas
                let id = document.createAttribute("id")
                let classe = document.createAttribute("class")
                let w = document.createAttribute("width")
                let h = document.createAttribute("height")
                
                //atribuindo valores aos atributos
                id.value = `nchart${i}`
                classe.value = "chartsjs"
                w.value = "33"
                h.value = "10"

                //atribuindo atributos aos elementos criados
                canv.setAttributeNode(id)
                canv.setAttributeNode(classe)
                canv.setAttributeNode(h)
                canv.setAttributeNode(w)

            }

            




            console.log("teste")

            
            let gender ={
                f:0,
                m:0,
                ns:0
            }
            //document.write(datas[0]["6. Qual o seu gênero?"])
            let gender2 ={
                s:0,
                m:0,
                p:0,
                pe:0
            }

            let gender1 ={
                a:0,
                g:0,
                r:0,
                d:0
            }
            //document.write(datas[0]["6. Qual o seu gênero?"])
            let gender3 ={
                m:0,
                n:0
            }

            let gender4 ={
                f:0,
                i:0,
                p:0,
                rc:0,
                rp:0,
                s:0
            }
            //document.write(datas[0]["6. Qual o seu gênero?"])
            let gender5 ={
                s:0,
                c:0,
                o:0
            }

            let gender6 ={//Possir deficiencia
                n:0,
                v:0
            }

            let gender7 ={//Conviver Deficiencia
                ad:0,
                at:0,
                s:0,
                n:0

            }

            let gender8 ={//Quantidade de filhos
                n:0,
                u:0,
                d:0,
                t:0
            }

            let gender9 ={//Com quem voce vive
                a:0,
                e:0,
                p:0,
                s:0
            }

            let gender10 ={//Quantas pessoas na sua casa
                a:0,
                b:0,
                c:0,
                d:0,
                e:0,
                f:0,
                g:0
            }

           
    
            for(let i = 0; i < datas.length; i++){
        
            if(datas[i]["6. Qual o seu gênero?"] === "Feminino"){
                gender.f++
            }else if(datas[i]["6. Qual o seu gênero?"] === "Masculino"){
                gender.m++
            }else{
                gender.ns++
            }
            } 
            //document.write("<hr><br>")
            
    
            for(let i = 0; i < datas.length; i++){
        
            if(datas[i]["4. Qual o estado do Brasil que você nasceu?"] === "São Paulo (SP)"){
                gender2.s++
            }else if(datas[i]["4. Qual o estado do Brasil que você nasceu?"] === "Minas Gerais (MG)"){
                gender2.m++
            }else if(datas[i]["4. Qual o estado do Brasil que você nasceu?"] === "Paraná (PR)"){
                gender2.p++
            }else{
                gender2.pe++
            }
            } 

            for(let i = 0; i < datas.length; i++){
        
            if(datas[i]["1. Qual o seu curso?"] === "Análise e Desenvolvimento de Sistemas (ADS)"){
                gender1.a++
            }else if(datas[i]["1. Qual o seu curso?"] === "Gestão de Recursos Humanos (GRH)"){
                gender1.r++
            }else if(datas[i]["1. Qual o seu curso?"] === "Gestão de Produção Industrial (GPI)"){
                gender1.g++
            }else {
                gender1.d++  
            }
            } 
            //document.write("<hr><br>")
            

            for(let i = 0; i < datas.length; i++){
        
            if(datas[i]["2. Qual o período que cursa?"] === "Matutino"){
                gender3.m++
            }else {
                gender3.n++
            }}


            for(let i = 0; i < datas.length; i++){
            
            if(datas[i]["5. Qual sua cidade de residência?"] === "Franca"){
                gender4.f++
            }else if(datas[i]["5. Qual sua cidade de residência?"] === "Ipuã"){
                gender4.i++
            }else if(datas[i]["5. Qual sua cidade de residência?"] === "Patrocínio Paulista"){
                gender4.p++
            }else if(datas[i]["5. Qual sua cidade de residência?"] === "Ribeirão Corrente"){
                gender4.rc++
            }else if(datas[i]["5. Qual sua cidade de residência?"] === "Ribeirão Preto"){
                gender4.rp++
            }else{
                gender4.s++
            }
            } 
            //document.write("<hr><br>")
            

            for(let i = 0; i < datas.length; i++){
        
            if(datas[i]["8. Qual é o seu estado civil?"] === "Solteiro(a)"){
                gender5.s++
            }else if(datas[i]["8. Qual é o seu estado civil?"] === "Casado(a) ou União Estável"){
                gender5.c++
            }else{
                gender5.o++
            }
            } 

            for(let i = 0; i < datas.length; i++){
        
            if(datas[i]["9. Você é portador de alguma necessidade especial?(Pode selecionar mais de uma, se for o caso)"] === "Visual"){
                gender6.v++
            }else {
                gender6.n++
            }
            } 

            for(let i = 0; i < datas.length; i++){
            
            if(datas[i]["10. Você convive ou mora com alguma pessoa com deficiência?"] === "Autismo"){
                gender7.at++
            }else if(datas[i]["10. Você convive ou mora com alguma pessoa com deficiência?"] === "Auditiva"){
                gender7.ad++
            }else if(datas[i]["10. Você convive ou mora com alguma pessoa com deficiência?"] === "Síndrome de Down"){
                gender7.s++
            }else{
                gender7.n++
            }
            } 

            for(let i = 0; i < datas.length; i++){
            
            if(datas[i]["11. Quantos filhos você tem?"] === "Um"){
                gender8.u++
            }else if(datas[i]["11. Quantos filhos você tem?"] === "Dois"){
                gender8.d++
            }else if(datas[i]["11. Quantos filhos você tem?"] === "Três"){
                gender8.t++
            }else{
                gender8.n++
            }
            } 

            for(let i = 0; i < datas.length; i++){
            
            if(datas[i]["12. Com quem você mora atualmente?"] === "Com amigos (compartilhando despesas) ou de favor"){
                gender9.a++
            }else if(datas[i]["12. Com quem você mora atualmente?"] === "Com esposa(o) e(ou) filho(s)"){
                gender9.e++
            }else if(datas[i]["12. Com quem você mora atualmente?"] === "Com pais e(ou) parentes"){
                gender9.p++
            }else{
                gender9.s++
            }
            } 

            for(let i = 0; i < datas.length; i++){
            
            if(datas[i]["13. Quantas pessoas, incluindo você, moram no seu domicílio?"] === 1){
                gender10.a++
            }else if(datas[i]["13. Quantas pessoas, incluindo você, moram no seu domicílio?"] === 2){
                gender10.b++
            }else if(datas[i]["13. Quantas pessoas, incluindo você, moram no seu domicílio?"] === 3){
                gender10.c++
            }else if(datas[i]["13. Quantas pessoas, incluindo você, moram no seu domicílio?"] === 4){
                gender10.d++
            }else if(datas[i]["13. Quantas pessoas, incluindo você, moram no seu domicílio?"] === 5){
                gender10.e++
            }else if(datas[i]["13. Quantas pessoas, incluindo você, moram no seu domicílio?"] === 6){
                gender10.f++
            }else{
                gender10.g++
            }
            }

            
        
        
                var ctx = document.getElementById("nchart1")
                var ctx2 = document.getElementById("nchart2")
                var ctx1 = document.getElementById("nchart3")
                var ctx3 = document.getElementById("nchart4")
                var ctx4 = document.getElementById("nchart5")
                var ctx5 = document.getElementById("nchart6")
                var ctx6 = document.getElementById("nchart7")
                var ctx7 = document.getElementById("nchart8")
                var ctx8 = document.getElementById("nchart9")
                var ctx9 = document.getElementById("nchart10")
                var ctx10 = document.getElementById("nchart11")

        
                var chartGraph = new Chart(ctx1,{
                    type: "doughnut",
                    data:{
                        labels: ["SP","MG","PR", "PE"],
                        datasets: [{
                            data:[gender2.s,gender2.m,gender2.p,gender2.pe],
                            
                            backgroundColor: ["#1639DB", "#ff6384", "#DBA400", "#FF5733"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '4. Qual o estado do Brasil que você nasceu?'
                        }
                    }
                })
        
                var chartGraph = new Chart(ctx4,{
                    type: "doughnut",
                    data:{
                        labels: ["Masculino","Feminino","Não sabe responder"],
                        datasets: [{
                            data:[gender.m,gender.f,gender.ns],
                            
                            backgroundColor: ["#1639DB", "#ff6384", "#DBA400"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '6. Qual o seu gênero?'
                        }
                    }
                })

                var chartGraph = new Chart(ctx,{
                    type: "doughnut",
                    data:{
                        labels: ["Análise e Desenvolvimento de Sistemas (ADS)","Gestão de Recursos Humanos (GRH)","Gestão de Produção Industrial (GPI)", "Desenvolvimento de Software Multi Plataforma (DSM)"],
                        datasets: [{
                            data:[gender1.a,gender1.g,gender1.r,gender1.d],
                            
                            backgroundColor: ["#1639DB", "#ff6384", "#DBA400", "#FF5733"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '1. Qual o seu curso?'
                        }
                    }
                })
        
                var chartGraph = new Chart(ctx2,{
                    type: "doughnut",
                    data:{
                        labels: ["Matutino","Noturno"],
                        datasets: [{
                            data:[gender3.m,gender3.n],
                            
                            backgroundColor: ["#1639DB", "#ff6384"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '2. Qual o período que cursa?'
                        }
                    }
                })

                var chartGraph = new Chart(ctx3,{
                    type: "doughnut",
                    data:{
                        labels: ["Franca","Ipuã","Patrocínio Paulista", "Ribeirão Corrente", "Ribeirão Preto", "S. José da Bela Vista"],
                        datasets: [{
                            data:[gender4.f,gender4.i,gender4.p,gender4.rc,gender4.rp,gender4.s],
                            
                            backgroundColor: ["#1639DB", "#ff6384", "#DBA400", "#FF5733", "#B9FF4D", "#79B324"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '5. Qual sua cidade de residência?'
                        }
                    }
                })
        
                var chartGraph = new Chart(ctx5,{
                    type: "doughnut",
                    data:{
                        labels: ["Solteiro(a)","Casado(a) ou União Estável","Separado(a), desquitado(a), divorciado(a)"],
                        datasets: [{
                            data:[gender5.s,gender5.c,gender5.o],
                            
                            backgroundColor: ["#1639DB", "#ff6384", "#DBA400"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '8. Qual é o seu estado civil?'
                        }
                    }
                })
                

                var chartGraph = new Chart(ctx6,{
                    type: "doughnut",
                    data:{
                        labels: ["Visual","Nenhum"],
                        datasets: [{
                            data:[gender6.v,gender6.n],
                            
                            backgroundColor: ["#1639DB", "#ff6384"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '9. Você é portador de alguma necessidade especial?(Pode selecionar mais de uma, se for o caso)'
                        }
                    }
                })

                var chartGraph = new Chart(ctx7,{
                    type: "doughnut",
                    data:{
                        labels: ["Autismo","Auditiva","Síndrome de Down", "Não convivo ou não moro com alguém com deficiência"],
                        datasets: [{
                            data:[gender7.at, gender7.ad, gender7.s, gender7.n],
                            
                            backgroundColor: ["#DBA400", "#FF5733", "#B9FF4D", "#79B324"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '10. Você convive ou mora com alguma pessoa com deficiência?'
                        }
                    }
                })

                var chartGraph = new Chart(ctx8,{
                    type: "doughnut",
                    data:{
                        labels: ["Um","Dois","Três", "Nenhum"],
                        datasets: [{
                            data:[gender8.u, gender8.d, gender8.t, gender8.n],
                            
                            backgroundColor: ["#DBA400", "#FF5733", "#B9FF4D", "#79B324"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '11. Quantos filhos você tem?'
                        }
                    }
                })

                var chartGraph = new Chart(ctx9,{
                    type: "doughnut",
                    data:{
                        labels: ["Com amigos (compartilhando despesas) ou de favor","Com esposa(o) e(ou) filho(s)","Com pais e(ou) parentes", "Sozinho"],
                        datasets: [{
                            data:[gender9.a, gender9.e, gender9.p, gender9.s],
                            
                            backgroundColor: ["#DBA400", "#FF5733", "#B9FF4D", "#79B324"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '12. Com quem você mora atualmente?'
                        }
                    }
                })


                var chartGraph = new Chart(ctx10,{
                    type: "doughnut",
                    data:{
                        labels: ["Uma","Duas","Três", "Quatro", "Cinco", "Seis", "Sete"],
                        datasets: [{
                            data:[gender10.a, gender10.b, gender10.c, gender10.d, gender10.e, gender10.f, gender10.g],
                            
                            backgroundColor: ["#DBA400", "#FF5733", "#B9FF4D", "#79B324","#1639DB", "#ff6384", "#dc597d"]
        
                        }]
                    },
                        options: {
                        title: {
                            display: true,
                            text: '13. Quantas pessoas, incluindo você, moram no seu domicílio?'
                        }
                    }
                })
                
                
        })
    </script>      
</body>
</html>